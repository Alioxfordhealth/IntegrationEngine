<?xml version="1.0" encoding="UTF-8"?>
<package xmlns="http://www.bpmi.org/2002/BPML/process" targetNamespace="OH Docman Generation" lastModified="1540222297091" version="2.40.1.0"><process name="OH Docman Generation" id="886ce089"><context/><action nomAffiche="OH Docman Generation" name="OH Docman Generation" id="da961158" comment="false"><documentation></documentation><input property="InputMessage" formatter="Texte"/><output><source property="InputMessage"/></output><action nomAffiche="Select attachments" name="actionActivity" id="77d180b6" comment="false"><documentation></documentation><input property="SQLResponse" formatter="XML"/><attributes xmlns=""><extension name="activityName">SqlSelect</extension><extension name="jdbcSource">Graphnet SQL Server</extension><extension name="compatibilite280">false</extension><extension name="query">select top 1 * from dbo.tmpattachment</extension></attributes></action><foreach nomAffiche="For Each row" comment="false" open="true" name="foreachActivity" id="b104e310" select="//row" xpathVersion1="false" formatter="XML"><documentation></documentation><source property="SQLResponse"/><sequence nomAffiche="Sequence Read document" comment="true" open="true" name="sequenceActivity" id="4e3d405"><documentation></documentation><context/><action nomAffiche="XPath query Attachment_File_Body" name="actionActivity" id="4a87585f" comment="false"><documentation></documentation><input property="attachedDocument" formatter="Texte"/><output><source property="SQLResponse"/></output><attributes xmlns=""><extension name="activityName">requeteXpath</extension><extension name="requete_xpath">//Attachment_File_Body/text()</extension><extension name="root_name"/><extension name="actionVide">chainevide</extension><extension name="useOutputEncoding">true</extension><extension name="xpathVersion1">false</extension></attributes></action><action nomAffiche="Base 64 Decode document" name="actionActivity" id="1e6a6b0" comment="false"><documentation></documentation><input property="attachedDocument" formatter="Binaire"/><output><source property="attachedDocument"/></output><attributes xmlns=""><extension name="activityName">base64</extension><extension name="decode_base64">true</extension></attributes></action><action nomAffiche="Run scenario" name="actionActivity" id="e9696685" comment="false"><documentation></documentation><input property="runRouteResponse_1" formatter="Texte"/><output><source property="doc"/></output><attributes xmlns=""><extension name="activityName">runRoute</extension><extension name="routeKey">Empty Scenario</extension><extension name="sendmode">asynchrone</extension></attributes></action></sequence><action nomAffiche="XSL transformation to kettering envelope" name="actionActivity" id="830f5558" comment="false"><documentation></documentation><input property="ketteringEnvelope" formatter="XML"/><output><source property="current"/></output><attributes xmlns=""><extension name="activityName">stylesheet</extension><extension name="stylesheetLocation">OHDatabaseTemplateToDocman.xsl</extension><extension name="xpathVersion1">false</extension></attributes></action><action nomAffiche="Create message SOAP Envelope" name="actionActivity" id="cf238634" comment="false"><documentation></documentation><input property="SOAPEnvelope" formatter="XML"/><attributes xmlns=""><extension name="activityName">creationMessage</extension><extension name="user_message">&lt;?xml version="1.0" encoding="utf-8"?&gt; &lt;soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"&gt; &lt;soap:Body&gt; &lt;EDT_AddDocumentXML xmlns="EDTwebns"&gt; &lt;rsKey&gt;0&lt;/rsKey&gt;@%$LF$%@&lt;rsXML&gt;&lt;/rsXML&gt; &lt;rsExtension&gt;0&lt;/rsExtension&gt; &lt;reStatus&gt;0&lt;/reStatus&gt; &lt;rsNewDocID&gt;0&lt;/rsNewDocID&gt; &lt;rsErr&gt;0&lt;/rsErr&gt; &lt;/EDT_AddDocumentXML&gt; &lt;/soap:Body&gt;&lt;/soap:Envelope&gt;@%$LF$%@</extension><extension name="useOutputEncoding">true</extension></attributes></action><action nomAffiche="Insert XML" name="actionActivity" id="85d5c665" comment="true"><documentation></documentation><input property="SOAPEnvelope" formatter="XML"/><attributes xmlns=""><extension name="activityName">insereMessageXml</extension><extension name="targetXPath">//*[local-name()='rsXML']</extension><extension name="sourceMessage">ketteringEnvelope</extension><extension name="sourceXPath">//ReportMsg</extension><extension name="targetMessage">SOAPEnvelope</extension><extension name="insertPosition">append</extension><extension name="xpathVersion1">false</extension></attributes></action><action nomAffiche="WS client" name="actionActivity" id="132562bc" comment="false"><documentation></documentation><input property="SOAPResponse" formatter="Texte"/><attributes xmlns=""><extension name="activityName">dynamicwebservice</extension><extension name="attemptNumber">1</extension><extension name="keyStorePwd"/><extension name="portName">EDTwebSoap</extension><extension name="exitOnFault">false</extension><extension name="timeout">120</extension><extension name="proxyPort"/><extension name="delairetr">60</extension><extension name="srvAcKeyStoreFile"/><extension name="checkHostname">false</extension><extension name="srvAcCertFile"/><extension name="srvAcKeyStorePwd"/><extension name="nbHeader">0</extension><extension name="wsdlURL">https://hub.docmansandpit.com/edt/edtwebservice.asmx?wsdl</extension><extension name="noError">true</extension><extension name="checkExpire">false</extension><extension name="userPass"/><extension name="requeteSoap">&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"&gt;&lt;soap:Body&gt;&lt;antares0:EDT_AddDocumentXML xmlns:antares0="EDTwebns"&gt;&lt;antares0:rsKey&gt;OXHEALTH2112&lt;/antares0:rsKey&gt;&lt;antares0:rsXML&gt;&lt;![CDATA[$ketteringEnvelope;]]&gt;&lt;/antares0:rsXML&gt;&lt;antares0:rsExtension&gt;1&lt;/antares0:rsExtension&gt;&lt;antares0:reStatus&gt;1&lt;/antares0:reStatus&gt;&lt;antares0:rsNewDocID&gt;12345&lt;/antares0:rsNewDocID&gt;&lt;antares0:rsErr&gt;0&lt;/antares0:rsErr&gt;&lt;/antares0:EDT_AddDocumentXML&gt;&lt;/soap:Body&gt;&lt;/soap:Envelope&gt;</extension><extension name="retourEnovacomMessage">false</extension><extension name="keyStoreFile"/><extension name="proxyPwd"/><extension name="soapAction">EDTwebns/EDT_AddDocumentXML</extension><extension name="useProxy">false</extension><extension name="serviceName">EDTweb</extension><extension name="userName"/><extension name="proxyHost"/><extension name="checkCrl">false</extension><extension name="sslAuthentication">sans</extension><extension name="wsURL">https://hub.docmansandpit.com/edt/edtwebservice.asmx</extension><extension name="proxyUser"/><extension name="sslACServer">sans</extension></attributes></action><action nomAffiche="Run scenario" name="actionActivity" id="e8cae055" comment="false"><documentation></documentation><input property="runRouteResponse_1" formatter="Texte"/><output><source property="SOAPResponse"/></output><attributes xmlns=""><extension name="activityName">runRoute</extension><extension name="routeKey">Empty Scenario</extension><extension name="sendmode">asynchrone</extension></attributes></action><context/></foreach><attributes xmlns=""><extension name="activityName">eventAction</extension><extension name="maxNumberOfThreads">1</extension></attributes></action></process></package>